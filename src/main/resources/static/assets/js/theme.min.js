const toggleSwitch=document.querySelector('.theme-switch input[type="checkbox"]'),currentTheme=localStorage.getItem("theme");function switchTheme(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"light"===currentTheme&&null!=toggleSwitch&&(toggleSwitch.checked=!0)),null!=toggleSwitch&&toggleSwitch.addEventListener("change",switchTheme,!1);
function setCookie(e,t,o){var n="";if(o){var a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3),n="; expires="+a.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var a=o[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}function setCurrentLocale(e){setCookie("Locale",e.toLowerCase(),30),location.reload()}window.addEventListener("pageshow",(function(e){(e.persisted||void 0!==window.performance&&2===window.performance.navigation.type)&&window.location.reload()})),function(){if($(".dropdown-menu a.dropdown-toggle").length&&$(".dropdown-menu a.dropdown-toggle").on("click",(function(e){return $(this).next().hasClass("show")||$(this).parents(".dropdown-menu").first().find(".show").removeClass("show"),$(this).next(".dropdown-menu").toggleClass("show"),$(this).parents("li.nav-item.dropdown.show").on("hidden.bs.dropdown",(function(e){$(".dropdown-submenu .show").removeClass("show")})),!1})),$('[data-bs-toggle="tooltip"]').length)[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e)}));if($('[data-bs-toggle="popover"]').length)[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map((function(e){return new bootstrap.Popover(e)}));if($("#cardRadioone , #cardRadioTwo").length&&($("#internetpayment").hide(),$("#cardRadioone").on("change",(function(){this.checked&&($("#cardpayment").show(),$("#internetpayment").hide())})),$("#cardRadioTwo").on("change",(function(){this.checked&&($("#internetpayment").show(),$("#cardpayment").hide())}))),$(".password-field input").length){$(".password-field input").on("keyup",(function(){var e=function(e){var t=0;e.length>=6&&(t+=1);e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(t+=1);e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(t+=1);return t}($(this).val()),t=$(this).parent(".password-field");t.removeClass((function(e,t){return(t.match(/\level\S+/g)||[]).join(" ")})),t.addClass("level"+e)}))}if($('[data-upload-id="courseImage"]').length){new FileUploadWithPreview.FileUploadWithPreview("courseImage")}if($("#nav-toggle").length&&$("#nav-toggle").on("click",(function(e){e.preventDefault(),$("#db-wrapper").toggleClass("toggled")})),$("#invoice").length&&$("#invoice").find(".print-link").on("click",(function(){$.print("#invoice")})),$(".sidebar-nav-fixed a").length&&$(".sidebar-nav-fixed a").on("click",(function(e){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=$(this.hash);(t=t.length?t:$("[name="+this.hash.slice(1)+"]")).length&&(e.preventDefault(),$("html, body").animate({scrollTop:t.offset().top-90},1e3,(function(){var e=$(t);if(e.focus(),e.is(":focus"))return!1;e.attr("tabindex","-1"),e.focus()})))}$(".sidebar-nav-fixed a").each((function(){$(this).removeClass("active")})),$(this).addClass("active")})),$("#checkAll").length&&$("#checkAll").on("click",(function(){$("input:checkbox").not(this).prop("checked",this.checked)})),$("#btn-icon").length&&$(".btn-icon").on("click",(function(){$(this).parent().addClass("active").siblings().removeClass("active")})),$(".stopevent").length&&$(document).on("click.bs.dropdown.data-api",".stopevent",(function(e){e.stopPropagation()})),$("input[name=tags]").length){var e=document.querySelector("input[name=tags]");new Tagify(e)}if($(".tagifyInput").each((function(e,t){new Tagify(t)})),$(".headingTyped").length){const c=$(".typedTextContent").text().split(", ");console.log(c);new Typed(".headingTyped",{strings:c,typeSpeed:30,backSpeed:30,backDelay:2e3,loop:!0})}if($(".needs-validation").length){var t=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(t).forEach((function(e){e.addEventListener("submit",(function(t){e.checkValidity()||(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")}),!1)}))}if($(".toast").length)[].slice.call(document.querySelectorAll(".toast")).map((function(e){return new bootstrap.Toast(e)}));if($(".offcanvas").length)[].slice.call(document.querySelectorAll(".offcanvas")).map((function(e){return new bootstrap.Offcanvas(e)}));if($(".dropdown-toggle").length)[].slice.call(document.querySelectorAll(".dropdown-toggle")).map((function(e){return new bootstrap.Dropdown(e)}));if($("#dataTableBasic").length&&$(document).ready((function(){$("#dataTableBasic").DataTable({responsive:!0})})),$("#liveAlertPlaceholder").length){var o=document.getElementById("liveAlertPlaceholder"),n=document.getElementById("liveAlertBtn");n&&n.addEventListener("click",(function(){var e,t,n;e="Nice, you triggered this alert message!",t="success",(n=document.createElement("div")).innerHTML='<div class="alert alert-'+t+' alert-dismissible" role="alert">'+e+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>',o.append(n)}))}if($("#typed").length)new Typed("#typed",{stringsElement:"#typed-strings",typeSpeed:40,backSpeed:40,backDelay:1e3,loop:!0});if($("#slider").length){var a=document.getElementById("slider");noUiSlider.create(a,{start:[32],connect:[!0,!1],range:{min:0,max:60},tooltips:[wNumb({decimals:0})]})}if($(".glightboxGallery").length)GLightbox({selector:".glightboxGallery"});const i=65565,r="/sign-in",l="/redirect-page",s="/stoody/api/v1",d=s+"/user";function p(e,t){$("#"+e).length?1==t?$("#"+e).show():$("#"+e).hide():console.log("There's no such element with this id:"+e)}function u(e,t){return $("#"+e).length?(t?$("#"+e).prop("disabled",!0):$("#"+e).prop("disabled",!1),!0):(console.log(e+" does not belong to any existing element!"),!1)}if($("#sign_in_page_submit_button").length&&$("#sign_in_page_submit_button").on("click",(function(){$("#sign_in_page_submit_button").attr("disabled",!0),$("#sign_in_page_submit_button_spinner").show();var e=new FormData;e.append("username",$("#username").val()),e.append("password",$("#password").val());var t={url:d+r,method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:e};$.ajax(t).done((function(e){$("#sign_in_page_submit_button_spinner").hide();let t=JSON.parse(e),o=t.responseStatus,n=t.response;"OTP_REQUIRED_AND_SENT"==o?window.location.href="/verify-password?openCode="+i:"SUCCESS"==o?(console.log(n),setCookie("Auth",n,7),window.location.href="/",console.log(getCookie("Auth"))):($("#sign_in_page_submit_button").attr("disabled",!1),$("#error_div").show())})).fail((function(){$("#sign_in_page_submit_button").attr("disabled",!1),$("#sign_in_page_submit_button_spinner").hide(),$("#error_div").show()}))})),$("#verify_password_page_submit_button").length&&$("#verify_password_page_submit_button").on("click",(function(){$("#verify_password_page_submit_button").attr("disabled",!0),$("#verify_password_page_submit_button_spinner").show();var e=new FormData;e.append("token",$("#validationCode").val()),e.append("username",$("#username").val());var t={url:d+r+"/verify",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:e};$.ajax(t).done((function(e){let t=JSON.parse(e),o=t.responseStatus,n=t.response;"SUCCESS"==o?(console.log(n),setCookie("Auth",n,7),window.location.href=l+"?openCode="+i+"&header=global.success&message=global.you_have_signed_in_successfully",console.log(getCookie("Auth"))):"FAIL"==o?($("#verify_password_page_submit_button").attr("disabled",!1),$("#error_div").show()):window.location.href="ACCOUNT_TEMPORAL_BLOCK_TOO_MANY_REQUESTS"==o?l+"?openCode="+i+"&header=global.account_blocked_temporarily&message=global.account_blocked_too_many_attempts":l+"?openCode="+i+"&header=global.error&message=global.unknown_error_happened_sorry"})).fail((function(){window.location.href=l+"?openCode="+i+"&header=global.error&message=global.unknown_error_happened_sorry"}))})),$("#profile_edit_update_picture_button").length&&($("#profile_edit_update_picture_button").on("click",(function(){$("#profile_edit_update_picture_input_file").click()})),$("#profile_edit_update_picture_input_file").on("change",(function(e){u("profile_edit_delete_picture_button",!0),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").show(),$("#profile_edit_page_avatar_error").hide();let t=new FormData;t.append("file",document.getElementById("profile_edit_update_picture_input_file").files[0]),console.log(document.getElementById("profile_edit_update_picture_input_file").files[0]);var o={url:"/stoody/api/v1/upload/put/small",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:t};$.ajax(o).done((function(e){try{let n=JSON.parse(e),a=n.responseStatus,i=n.response;if("SUCCESS"==a){var t=new FormData;t.append("pictureURL",i);var o={url:"/stoody/api/v1/user/update/picture",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:t};$.ajax(o).done((function(e){let t=JSON.parse(e),o=t.responseStatus;t.response;"SUCCESS"==o?location.reload():(u("profile_edit_delete_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show())})).fail((function(){u("profile_edit_delete_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show()}))}else u("profile_edit_delete_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show()}catch(e){u("profile_edit_delete_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show()}})).fail((function(){u("profile_edit_delete_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show()}))}))),$("#profile_edit_delete_picture_button").length&&$("#profile_edit_delete_picture_button").on("click",(function(){u("profile_edit_update_picture_button",!0),$("#profile_edit_delete_picture_button_spinner").show(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").hide();$.ajax({url:"/stoody/api/v1/user/delete/picture",method:"POST",timeout:0}).done((function(e){location.reload()})).fail((function(){u("profile_edit_update_picture_button",!1),$("#profile_edit_delete_picture_button_spinner").hide(),$("#profile_edit_update_picture_button_spinner").hide(),$("#profile_edit_page_avatar_error").show()}))})),$("#social_profiles_page_id").length){let f=document.getElementById("editor");setInterval((function(){f.querySelector(".ql-editor").innerHTML.length>13e3?$("#social_profile_page_editor_error").show():$("#social_profile_page_editor_error").hide();let e=document.getElementById("userSkills").value.length<1?null:JSON.parse(document.getElementById("userSkills").value),t="";if(null!=e)for(let o=0;o<e.length;o++)t+=o<1?e[o].value:", "+e[o].value;t.length>254?$("#social_profile_page_tagify_error").show():$("#social_profile_page_tagify_error").hide(),$("#social_profile_page_tagify_error").is(":visible")||$("#social_profile_page_editor_error").is(":visible")?p("social_profiles_page_submit_button",!1):p("social_profiles_page_submit_button",!0)}),500),$("#social_profiles_page_submit_button").on("click",(function(){$("#social_profiles_page_alert_div").hide();let e=document.getElementById("userSkills").value.length<1?null:JSON.parse(document.getElementById("userSkills").value),t="";if(null!=e)for(let o=0;o<e.length;o++)t+=o<1?e[o].value:","+e[o].value;let o=f.querySelector(".ql-editor").innerHTML,n=document.getElementById("twitterURL").value,a=document.getElementById("facebookURL").value,i=document.getElementById("githubURL").value,r=document.getElementById("instagramURL").value,l=document.getElementById("linkedInURL").value,s=document.getElementById("youtubeURL").value;var d=new FormData;d.append("twitterURL",n),d.append("facebookURL",a),d.append("githubURL",i),d.append("instagramURL",r),d.append("linkedinURL",l),d.append("youtubeURL",s),d.append("skills",t),d.append("aboutUser",o);var p={url:"/stoody/api/v1/user/social/profiles/update",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:d};$.ajax(p).done((function(e){console.log(e),"SUCCESS"==JSON.parse(e).responseStatus?location.reload():$("#social_profiles_page_alert_div").show()})).fail((function(){$("#social_profiles_page_alert_div").show()}))}))}$("#preview_user_page_follow_button").length&&$("#preview_user_page_follow_button").on("click",(function(){$("#preview_user_page_follow_button").attr("disabled",!0);let e=new FormData,t=$(this).attr("data-username-string"),o=$(this).attr("data-preview-username-string");e.append("userFrom",t),e.append("userTo",o);let n={url:"/stoody/api/v1/user/follow/add",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:e};$.ajax(n).done((function(e){console.log(e),"SUCCESS"==JSON.parse(e).responseStatus?location.reload():console.log("User could not be followed! (Reason is necessary!)"),$("#preview_user_page_follow_button").attr("disabled",!1)})).fail((function(){$("#preview_user_page_follow_button").attr("disabled",!1),console.log("Request is failed!")}))})),$("#preview_user_page_unfollow_button").length&&$("#preview_user_page_unfollow_button").on("click",(function(){$("#preview_user_page_unfollow_button").attr("disabled",!0);let e=new FormData,t=$(this).attr("data-username-string"),o=$(this).attr("data-preview-username-string");e.append("userFrom",t),e.append("userTo",o);let n={url:"/stoody/api/v1/user/follow/remove",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:e};$.ajax(n).done((function(e){console.log(e),"SUCCESS"==JSON.parse(e).responseStatus?location.reload():console.log("User could not be followed! (Reason is necessary!)"),$("#preview_user_page_unfollow_button").attr("disabled",!1)})).fail((function(){$("#preview_user_page_unfollow_button").attr("disabled",!1),console.log("Request is failed!")}))})),$("#preview_user_page_report_button").length&&$("#preview_user_page_report_button").on("click",(function(){const e=$("#reportReasonText").val();if(e.length<1)return void $("#reportAlertContainer").show();$("#preview_user_page_report_button").attr("disabled");let t=$(this).attr("data-username-string"),o=$(this).attr("data-preview-username-string");var n=new FormData;n.append("reportedBy",t),n.append("reportedUser",o),n.append("reportReason",e);var a={url:"/users/preview/report",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:n};$.ajax(a).done((function(e){console.log(e);let t=JSON.parse(e).response;$("#reportContainer").hide(),$("#reportAlertContainer").show(),$("#reportAlertContainer").text(t)})).fail((function(){location.reload()}))}));for(let g=1;g<=21;g++)if(0!==$("#user_profile_navbar_button_"+g+"_page").length){document.getElementById("user_profile_navbar_button_"+g).parentNode.classList.add("active");break}if($("#standard_navbar_code_a").length){function _(e){var t={url:"/user/status/setme"+e,method:"POST",timeout:0};$.ajax(t).done((function(e){"SUCCESS"==e.responseStatus?location.reload():console.log("setting user status failed")}))}$("#standard_navbar_user_status_online").on("click",(function(){_("online")})),$("#standard_navbar_mobile_version_user_status_online").on("click",(function(){_("online")})),$("#standard_navbar_user_status_offline").on("click",(function(){_("offline")})),$("#standard_navbar_mobile_version_user_status_offline").on("click",(function(){_("offline")})),$("#standard_navbar_user_status_away").on("click",(function(){_("away")})),$("#standard_navbar_mobile_version_user_status_away").on("click",(function(){_("away")})),$("#standard_navbar_user_status_busy").on("click",(function(){_("busy")})),$("#standard_navbar_mobile_version_user_status_busy").on("click",(function(){_("busy")}))}if($("#helpCenterGlobalSearchBarForm").length){let h=$("#helpCenterGlobalSearchBarForm");$("#helpCenterGlobalSearchBarButton").on("click",(function(){h.find("#helpCenterGlobalSearchBarInput").val().length<1||(window.location.href="/help/search/"+h.find("#helpCenterGlobalSearchBarInput").val())}))}$("#helpCenterLandingSearchForm").length&&$("#helpCenterLandingSearchFormButton").on("click",(function(){window.location.href="/help/search/"+$("#helpCenterLandingSearchFormInput").val()})),$("#help_center_manage_content_page").length&&(console.log("AMK"),$("#pills-development-tab").on("click",(function(){$("#contentPreviewer").html("")})),$("#pills-design-tab").on("click",(function(){$("#content").val().length>0?$("#contentPreviewer").html($("#content").val()):$("#contentPreviewer").html('<div class="p-3">Your HTML Content Preview</div>')}))),$("#internationalization_page_id").length&&$("#locale").on("input",(function(){$("#localeFlag").removeClass();let e="en"==$("#locale").val()?"us":$("#locale").val();$("#localeFlag").addClass("fi fi-"+e)}))}();
if($("#course_configuration_page").length){const e=$("#course_configuration_page");let t=$("#course_thumbnail_input_file"),o=$("#course_thumbnail_input_remove"),i=$("#course_promo_video_input_file"),l=$("#course_promo_video_input_name"),n=$("#course_promo_video_input_remove"),a=$("#course_configuration_page_add_section_button"),r=document.getElementById("course_configuration_page_add_section_input"),u=$("#course_configuration_page_curriculum_modal_add_lecture_button"),s=document.getElementById("course_configuration_page_curriculum_modal_input"),c=$("#uploadStartButton"),d=0;function getBlankLecture(){return{id:0,title:"",article:new FormData,articleName:"",description:"",uiCollapsed:!1}}function getBlankSection(){return{id:0,title:"",lectures:[]}}function getBlankCourse(){return{courseId:-1,congratulationsMessage:"",contextTags:"",courseCategoryId:0,courseStatus:0,currency:"",description:"",discount:"",languageCode:"",level:0,price:0,promoVideoName:"",promoVideoURL:"",sections:[],tags:"",thumbnailName:"",thumbnailURL:"",title:"",welcomeMessage:""}}let p=getBlankCourse();function checkIfObject(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function $inputFileHandler(e,t,o,i,l,n){i?(e.hide(),t.show(),t.text(l),o.show(),o.off()):(t.hide(),o.hide(),o.hide(),e.show(),e.val("")),n instanceof Function&&n()}function courseThumbnailInputAdded(){$inputFileHandler(t,$("#course_thumbnail_input_name"),o,!0,p.thumbnailName,null),o.on("click",(function(){$inputFileHandler(t,$("#course_thumbnail_input_name"),o,!1,p.thumbnailName,(function(){p.thumbnailName="",p.thumbnailURL=""}))}))}function coursePromoVideoInputAdded(){$inputFileHandler(i,l,n,!0,p.promoVideoName,null),n.on("click",(function(){$inputFileHandler(i,l,n,!1,p.promoVideoName,(function(){p.promoVideoName="",p.promoVideoURL=""}))}))}function updateStaticFields(){$("#courseTitle").val(p.title),$("#courseContextTags").val(p.contextTags),document.getElementById("editor").querySelector(".ql-editor").innerHTML=p.description,p.thumbnailName.length>0&&courseThumbnailInputAdded(),p.promoVideoName.length>0&&coursePromoVideoInputAdded(),$("#courseCategory").val(p.courseCategoryId),$("#courseLevel").val(p.level),$("#coursePriceInput").val(p.price),$("#coursePriceDiscountInput").val(p.discount),$("#welcomeMessageInput").val(p.welcomeMessage),$("#congratulationMessage").val(p.congratulationsMessage),$("#courseTagsInput").val(p.tags),updateCurriculum()}function updateCurriculum(){let e=$("#courseSectionContents");e.children().off(),e.html(""),0==p.sections.length?$("#courseSectionEmptyMessage").show():$("#courseSectionEmptyMessage").hide();for(let t=0;t<p.sections.length;t++){let o=$("#courseSectionElementReference").clone();o.show(),o.attr("id",o.attr("id")+t);let i=o.find("#courseSectionElementHeader");i.attr("id",i.attr("id")+t),i.val(p.sections[t].title),i.on("input",(function(){p.sections[t].title=i.val()}));let l=o.find("#courseSectionElementRemoveButton");l.attr("id",l.attr("id")+t),l.on("click",(function(e){p.sections.splice(t,1),updateCurriculum()}));let n=o.find("#sectionLectureList");n.attr("id",n.attr("id")+t);let a=n.find("#courseListElement");a.attr("id",a.attr("id")+t);let r=n.find("#sectionLecturesPasteArea");r.children().off(),r.html("");let u=o.find("#emptySectionMessage");u.attr("id",u.attr("id")+t),p.sections[t].lectures.length<1?u.show():u.hide();for(let e=0;e<p.sections[t].lectures.length;e++){let o=n.find("#lectureDiv").clone();o.attr("id",o.attr("id")+e),o.show();let i=o.find("#lectureHeader");i.attr("id",i.attr("id")+e),i.val(p.sections[t].lectures[e].title),i.on("input",(function(){p.sections[t].lectures[e].title=i.val()}));let l=o.find("#lectureCollapseList");l.attr("id","lectureCollapseList"+t+"_"+e),l.attr("aria-labelledby",a.attr("id")),l.attr("data-bs-parent",n.attr("id"));let u=o.find("#lectureCollapseButton");u.attr("data-bs-target","#"+l.attr("id")),u.attr("aria-controls",l.attr("id")),0==p.sections[t].lectures[e].uiCollapsed?(u.attr("aria-expanded","true"),l.addClass("show")):(u.addClass("collapsed"),u.attr("aria-expanded","false")),l.on("shown.bs.collapse",(function(){p.sections[t].lectures[e].uiCollapsed=!1})),l.on("hidden.bs.collapse",(function(){p.sections[t].lectures[e].uiCollapsed=!0})),o.find("#lecture_remove").on("click",(function(){p.sections[t].lectures.splice(e,1),updateCurriculum()}));let s=l.find("#lecture_article");s.attr("id",s.attr("id")+e);let c=s.find("#lectureArticleInputFilled");if(c.attr("id",c.attr("id")+e),p.sections[t].lectures[e].articleName.length>0){s.show();let o=s.find("#lecture_article_input_file");o.attr("id",o.attr("id")+e),o.hide();let i=c.find("#lecture_article_input_file_name");i.attr("id",i.attr("id")+e),i.show(),i.text(p.sections[t].lectures[e].articleName);let l=c.find("#lecture_article_input_file_remove");l.show(),l.on("click",(function(){p.sections[t].lectures[e].articleName="",p.sections[t].lectures[e].article=new FormData,updateCurriculum()}))}else{let i=o.find("#lecture_add_article_button");i.show(),i.attr("id",i.attr("id")+e),i.on("click",(function(){s.show();let o=s.find("#lecture_article_input_file");o.on("change",(function(){let i=o.val().replace(/C:\\fakepath\\/i,""),l=new FormData;l.append("file",o[0].files[0]),p.sections[t].lectures[e].article=l,p.sections[t].lectures[e].articleName=i,updateCurriculum()})),i.hide()}))}let d=o.find("#lecture_description");if(d.attr("id",d.attr("id")+e),p.sections[t].lectures[e].description.length>0){d.show();let o=d.find("#lecture_description_input");o.attr("id",o.attr("id")+e),o.val(p.sections[t].lectures[e].description),o.on("input",(function(){p.sections[t].lectures[e].description=$(this).val()}))}else{let i=o.find("#lecture_add_description_button");i.show(),i.attr("id",i.attr("id")+e),i.on("click",(function(){d.show();let o=d.find("#lecture_description_input");o.attr("id",o.attr("id")+e),o.on("input",(function(){p.sections[t].lectures[e].description=$(this).val()})),i.hide()}))}o.appendTo(r)}let s=o.find("#section_add_lecture_button");s.attr("id","section_add_lecture_button"+t),s.on("click",(function(){d=t})),o.appendTo(e)}}function fetchInitialData(){try{if(isNaN(e.attr("data-course-id"))||(p.courseId=e.attr("data-course-id")),-1!=p.courseId){let e={url:"http://localhost:8080/course/findCourseWithDetails/"+courseId,method:"GET",timeout:0};$.ajax(e).done((function(e){try{p=e.response,updateStaticFields(),console.log(e.response),console.log(e.responseStatus)}catch(e){console.log(e),p=getBlankCourse(),updateStaticFields()}}))}}catch(e){p=getBlankCourse(),updateStaticFields(),console.log(e)}}t.on("change",(function(){let e=new FormData;e.append("file",t[0].files[0]),p.thumbnailName=t[0].files[0].name,p.thumbnailURL=e,courseThumbnailInputAdded()})),i.on("change",(function(){let e=new FormData;e.append("file",i[0].files[0]),p.promoVideoName=i[0].files[0].name,p.promoVideoURL=e,coursePromoVideoInputAdded()})),c.on("click",(function(){$("#uploadModal").modal("hide"),$("#courseForm").hide(),$("#courseFormHeader").hide(),$("#uploadForm").show(),$("#courseUploadProgressBarBottomText").show();let e=$("#uploadFormProgressBar"),t=$("#uploadLogger");t.html("");let o=[],i=0,l=0,n=0,a=0,r=0;function u(e){t.html(t.html()+'<span class="bg-dark-warning-soft">'+e+"</span><br>")}function s(e){var t=Math.pow(10,1);return(e=Math.round(e/1024))<1e3?e+" KB":(e=Number.parseFloat(e/1024))<1e3?Math.round(e*t)/t+" MB":(e=Number.parseFloat(e/1024),Math.round(e*t)/t+" GB")}function c(e){e?$("#uploadFormNextButton").on("click",(function(){window.location.href="/"})):$("#uploadFormNextButton").off()}c(!1),p.title=$("#courseTitle").val(),p.title.length<1&&(p.title="Untitled");let d=$("#courseTagsInput").val().length<1?null:JSON.parse($("#courseTagsInput").val()),m="";if(null!=d)for(let e=0;e<d.length;e++)m+=e<1?d[e].value:","+d[e].value;p.tags=m;let f=document.getElementById("courseContextTags").value.length<1?null:JSON.parse(document.getElementById("courseContextTags").value),h="";if(null!=f)for(let e=0;e<f.length;e++)h+=e<1?f[e].value:","+f[e].value;p.contextTags=h,p.courseCategoryId=$("#courseCategory").prop("selectedIndex"),null!=p.courseCategoryId&&null!=p.courseCategoryId||(p.courseCategoryId=1),p.level=$("#courseLevel").prop("selectedIndex"),null!=p.level&&null!=p.level||(p.level=0);let g=document.getElementById("editor").querySelector(".ql-editor").innerHTML;p.description=g,$("#uploadFormCourseTitle").text(p.title),p.price=$("#coursePriceInput").val(),null!=p.price&&null!=p.price||(p.price=0),p.discount=$("#coursePriceDiscountInput").val(),null!=p.discount&&null!=p.discount||(p.discount=0),p.welcomeMessage=$("#welcomeMessageInput").val(),p.congratulationsMessage=$("#congratulationMessage").val(),u("Uploading assets is started..."),u("Checking the assets...");let _=[];if(p.thumbnailName.length>0&&p.thumbnailURL instanceof FormData){l+=p.thumbnailURL.get("file").size,i++;var b={url:"http://localhost:8080/stoody/api/v1/upload/put/small",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:p.thumbnailURL};let t=$.ajax(b).done((function(t){let c=JSON.parse(t),d=c.responseStatus,m=c.response;"SUCCESS"==d?(u(p.thumbnailURL.get("file").name+" uploaded successfully."),r+=p.thumbnailURL.get("file").size,u(s(r)+"/"+s(l)+" uploaded successfully."),p.thumbnailURL=m):(u(p.thumbnailURL.get("file").name+" could not be uploaded."),o.push(p.thumbnailURL.get("file").name+" could not be uploaded.")),n++,a=n/i*100,e.css("width",a+"%")})).fail((function(){u(p.thumbnailURL.get("file").name+" could not be uploaded. Bad Request."),o.push(p.thumbnailURL.get("file").name+" could not be uploaded. Bad Request.")}));_.push(t)}if(p.promoVideoName.length>0&&p.promoVideoURL instanceof FormData){l+=p.promoVideoURL.get("file").size,i++;b={url:"http://localhost:8080/stoody/api/v1/upload/put/small",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:p.promoVideoURL};let t=$.ajax(b).done((function(t){let c=JSON.parse(t),d=c.responseStatus,m=c.response;"SUCCESS"==d?(u(p.promoVideoURL.get("file").name+" uploaded successfully."),r+=p.promoVideoURL.get("file").size,u(s(r)+"/"+s(l)+" uploaded successfully."),p.promoVideoURL=m):(u(p.promoVideoURL.get("file").name+" could not be uploaded."),o.push(p.promoVideoURL.get("file").name+" could not be uploaded.")),n++,a=n/i*100,e.css("width",a+"%")})).fail((function(){u(p.promoVideoURL.get("file").name+" could not be uploaded. Bad Request."),o.push(p.promoVideoURL.get("file").name+" could not be uploaded. Bad Request.")}));_.push(t)}for(let t=0;t<p.sections.length;t++)for(let c=0;c<p.sections[t].lectures.length;c++)try{let d=p.sections[t].lectures[c];if(d.article instanceof FormData){l+=d.article.get("file").size,i++;b={url:"http://localhost:8080/stoody/api/v1/upload/put/small",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:d.article};let t=$.ajax(b).done((function(t){let c=JSON.parse(t),p=c.responseStatus,m=c.response;"SUCCESS"==p?(u(d.article.get("file").name+" uploaded successfully."),r+=d.article.get("file").size,u(s(r)+"/"+s(l)+" uploaded successfully."),d.article=m):(u(d.article.get("file").name+" could not be uploaded."),o.push(d.article.get("file").name+" could not be uploaded.")),n++,a=n/i*100,e.css("width",a+"%")})).fail((function(){u(d.article.get("file").name+" could not be uploaded. Bad Request."),o.push(d.article.get("file").name+" could not be uploaded. Bad Request.")}));_.push(t)}else d.article.length<1&&d.description.length<1&&u("Section: "+t+" Lecture: "+c+" contains neither article nor description.")}catch(e){u("An error occured while uploading: "+e),o.push("An error occured while uploading: "+e)}function v(){$("#courseUploadProgressBarBottomText").hide(),e.css("width","100%"),$("#uploadFormHeaderText").hide(),$("#uploadFormHeaderSpinner").hide(),$("#uploadFormHeaderDoneWithErrorsIcon").show(),$("#uploadFormCompleteButtonSpinner").hide(),o.length>0?u("Uploading assets is failed: "+o):u("Uploading assets is failed..."),u("Course could not be updated."),c(!0)}$.when.apply(null,_).done((function(){checkIfObject(p.description)&&(p.description=JSON.stringify(p.description)),p.description=p.description.trim();for(let e=0;e<p.sections.length;e++)for(let t=0;t<p.sections[e].lectures.length;t++){let o=p.sections[e].lectures[t];checkIfObject(o.article)&&(o.article=JSON.stringify(o.article))}checkIfObject(p.thumbnailURL)&&(p.thumbnailURL=JSON.stringify(p.thumbnailURL)),checkIfObject(p.promoVideoURL)&&(p.promoVideoURL=JSON.stringify(p.promoVideoURL));var e={url:"http://localhost:8080/course/save",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify(p)};$.ajax(e).done((function(e){u("The total size of the uploaded files: "+s(l)),$("#uploadFormHeaderText").hide(),$("#uploadFormHeaderSpinner").hide(),$("#uploadFormHeaderDoneIcon").show(),$("#uploadFormCompleteButtonSpinner").hide(),o.length>0?u("Uploading assets is finished with errors:"+o):u("Uploading assets is finished..."),u("Course is updated."),$("#courseUploadProgressBarBottomText").hide(),c(!0)})).fail((function(){o+=" Request could not be made. Course parameters were invalid.",v()}))})).fail((function(){v()}))})),a.on("click",(function(){if(p.sections.length>=20)return;let e=r.value;if(e.length<1)return;let t=getBlankSection();t.title=e,p.sections.push(t),updateCurriculum()})),u.on("click",(function(){if(p.sections[d].lectures.length>20)return;let e=s.value;if(e.length<1)return;let t=getBlankLecture();t.title=e,console.log(d),p.sections[d].lectures.push(t),updateCurriculum()})),fetchInitialData()}
"use strict";!function(){var i=window.location+"",t=i.replace(window.location.protocol+"//"+window.location.host+"/","");$("ul#sidebarnav a").filter((function(){return this.href===i||this.href===t})).parentsUntil(".sidebar-nav").each((function(i){$(this).is("li")&&0!==$(this).children("a").length?($(this).children("a").addClass("active"),$(this).parent("ul#sidebarnav").length,$(this).addClass("active")):$(this).is("ul")||0!==$(this).children("a").length?$(this).is("ul")&&$(this).addClass("in"):$(this).addClass("active")}))}();